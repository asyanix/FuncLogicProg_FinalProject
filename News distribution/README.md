## –ó–∞–¥–∞—á–∞ 1167C "–†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–µ–π"

–û–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –∑–∞–¥–∞—á–µ–π –ø–æ–¥—Ä–æ–±–Ω–µ–µ –º–æ–∂–Ω–æ [–∑–¥–µ—Å—å](https://codeforces.com/problemset/problem/1167/C).

–†–µ—à–µ–Ω–∏–µ –Ω–∞ C# [–∑–¥–µ—Å—å](/News%20distribution/NewsCSharp/Program.cs).

–†–µ—à–µ–Ω–∏–µ –Ω–∞ F# [–∑–¥–µ—Å—å](/News%20distribution/NewsFSharp/Program.fs).

---

## –û–ø–∏—Å–∞–Ω–∏–µ

–í –Ω–µ–∫–æ—Ç–æ—Ä–æ–π —Å–æ—Ü–∏–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã ùëõ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –û–Ω–∏ –æ–±—â–∞—é—Ç—Å—è –º–µ–∂–¥—É —Å–æ–±–æ–π –≤ ùëö –≥—Ä—É–ø–ø–∞—Ö. –î–∞–≤–∞–π—Ç–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –ø—Ä–æ—Ü–µ—Å—Å —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –Ω–æ–≤–æ—Å—Ç–µ–π –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏.

–ò–∑–Ω–∞—á–∞–ª—å–Ω–æ –∫–∞–∫–æ–π-–Ω–∏–±—É–¥—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ùë• —É–∑–Ω–∞–µ—Ç –Ω–æ–≤–æ—Å—Ç—å –∏–∑ –∫–∞–∫–æ–≥–æ-—Ç–æ –≤–Ω–µ—à–Ω–µ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞. –ó–∞—Ç–µ–º —ç—Ç–æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–æ–≤–æ—Å—Ç—å –≤—Å–µ–º —Å–≤–æ–∏–º –¥—Ä—É–∑—å—è–º (–¥–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å—á–∏—Ç–∞—é—Ç—Å—è –¥—Ä—É–∑—å—è–º–∏, –µ—Å–ª–∏ –æ–Ω–∏ –æ–±–∞ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç –∫ –∫–∞–∫–æ–π-–Ω–∏–±—É–¥—å –≥—Ä—É–ø–ø–µ). –î—Ä—É–∑—å—è –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –Ω–æ–≤–æ—Å—Ç—å —Å–≤–æ–∏–º –¥—Ä—É–∑—å—è–º, –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ. –ü—Ä–æ—Ü–µ—Å—Å –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –Ω–µ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –Ω–∏ –æ–¥–Ω–æ–π –ø–∞—Ä—ã –¥—Ä—É–∑–µ–π, –≤ –∫–æ—Ç–æ—Ä–æ–π –æ–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–Ω–∞–µ—Ç –Ω–æ–≤–æ—Å—Ç—å, –∞ –¥—Ä—É–≥–æ–π ‚Äî –Ω–µ—Ç.

–î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ùë• –æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ, —Å–∫–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –∫–æ–Ω–µ—á–Ω–æ–º –∏—Ç–æ–≥–µ —É–∑–Ω–∞–µ—Ç –Ω–æ–≤–æ—Å—Ç—å, –µ—Å–ª–∏ ùë• –Ω–∞—á–Ω–µ—Ç –µ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è—Ç—å.

#### –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
–í –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–µ –∑–∞–ø–∏—Å–∞–Ω—ã –¥–≤–∞ —Ü–µ–ª—ã—Ö —á–∏—Å–ª–∞ ùëõ –∏ ùëö (1 ‚â§ ùëõ,ùëö ‚â§ 5*10^5) ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –≥—Ä—É–ø–ø, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ.

–ó–∞—Ç–µ–º —Å–ª–µ–¥—É—é—Ç ùëö —Å—Ç—Ä–æ–∫, –∫–∞–∂–¥–∞—è –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –æ–ø–∏—Å—ã–≤–∞–µ—Ç –≥—Ä—É–ø–ø—É. ùëñ-—è —Å—Ç—Ä–æ–∫–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Ü–µ–ª—ã–º —á–∏—Å–ª–æ–º ùëòùëñ (0 ‚â§ ùëò_ùëñ ‚â§ ùëõ) ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ ùëñ-–π –≥—Ä—É–ø–ø–µ. –ó–∞—Ç–µ–º —Å–ª–µ–¥—É—é—Ç ùëò_ùëñ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —á–∏—Å–µ–ª, –æ–±–æ–∑–Ω–∞—á–∞—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—â–∏—Ö –∫ ùëñ-–π –≥—Ä—É–ø–ø–µ.

#### –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
–í—ã–≤–µ–¥–∏—Ç–µ ùëõ —Ü–µ–ª—ã—Ö —á–∏—Å–µ–ª. ùëñ-–µ –∏–∑ –Ω–∏—Ö –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Ä–∞–≤–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ —É–∑–Ω–∞—é—Ç –Ω–æ–≤–æ—Å—Ç—å, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ùëñ –Ω–∞—á–Ω–µ—Ç –µ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è—Ç—å.

---

## –†–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏

–í –∑–∞–¥–∞–Ω–Ω–æ–π —Å–æ—Ü–∏–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç:
- **n –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**, –æ–±–æ–∑–Ω–∞—á–∞–µ–º—ã—Ö —Ü–µ–ª—ã–º–∏ —á–∏—Å–ª–∞–º–∏ –æ—Ç 1 –¥–æ n,
- **m –≥—Ä—É–ø–ø**, –∫–∞–∂–¥–∞—è –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å—á–∏—Ç–∞—é—Ç—Å—è –¥—Ä—É–∑—å—è–º–∏, –µ—Å–ª–∏ —Å–æ—Å—Ç–æ—è—Ç –≤ –æ–¥–Ω–æ–π –∏ —Ç–æ–π –∂–µ –≥—Ä—É–ø–ø–µ. –ü—Ä–∏ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–∏ –Ω–æ–≤–æ—Å—Ç–∏ –æ—Ç –Ω–µ–∫–æ—Ç–æ—Ä–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è x, –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤—Å–µ–º –¥—Ä—É–∑—å—è–º, –∞ –∑–∞—Ç–µ–º –¥—Ä—É–∑—å—è–º –¥—Ä—É–∑–µ–π, –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ.

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ –≤ —Ç–µ—Ä–º–∏–Ω–∞—Ö —Ç–µ–æ—Ä–∏–∏ –≥—Ä–∞—Ñ–æ–≤:

–ü—É—Å—Ç—å –≥—Ä–∞—Ñ **G = (V, E)** —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ n –≤–µ—Ä—à–∏–Ω, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º (V = {1, 2, ..., n}).

–î–æ–±–∞–≤–∏–º —Ä–µ–±—Ä–æ –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ u –∏ v, –µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞ –≥—Ä—É–ø–ø–∞, –≤ –∫–æ—Ç–æ—Ä—É—é –≤—Ö–æ–¥—è—Ç –æ–±–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –≤ –≥—Ä–∞—Ñ–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å–æ—Å–µ–¥—Å—Ç–≤–∞ —á–µ—Ä–µ–∑ –≥—Ä—É–ø–ø—ã, –∏ –∑–∞–¥–∞—á–∞ —Å–≤–æ–¥–∏—Ç—Å—è –∫ –≤—ã—á–∏—Å–ª–µ–Ω–∏—é —Ä–∞–∑–º–µ—Ä–æ–≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å–≤—è–∑–Ω–æ—Å—Ç–∏ –≤ –≥—Ä–∞—Ñ–µ G.

–ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å x –Ω–∞—á–∏–Ω–∞–µ—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è—Ç—å –Ω–æ–≤–æ—Å—Ç—å, —Ç–æ –æ–Ω–∞ –¥–æ–π–¥—ë—Ç –¥–æ –≤—Å–µ—Ö –≤–µ—Ä—à–∏–Ω –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ —Å–≤—è–∑–Ω–æ—Å—Ç–∏, –∫ –∫–æ—Ç–æ—Ä–æ–π –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –≤–µ—Ä—à–∏–Ω–∞ x.

–ü–µ—Ä–µ—Ñ—Ä–∞–∑–∏—É—Ä–µ–º –∑–∞–¥–∞—á—É –≤ —Ç–µ—Ä–º–∏–Ω–∞—Ö —Ç–µ–æ—Ä–∏–∏ –≥—Ä–∞—Ñ–æ–≤. –ü—É—Å—Ç—å –ª—é–¥–∏ –±—É–¥—É—Ç –≤–µ—Ä—à–∏–Ω–∞–º–∏, –≤–µ—Ä—à–∏–Ω—ã x –∏ y —Å–æ–µ–¥–∏–Ω–µ–Ω—ã —Ä–µ–±—Ä–æ–º, –µ—Å–ª–∏ —É x –∏ y –µ—Å—Ç—å –∫–∞–∫–∞—è-–Ω–∏–±—É–¥—å –æ–±—â–∞—è –≥—Ä—É–ø–ø–∞. –ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ, –µ—Å–ª–∏ x –Ω–∞—á–∏–Ω–∞–µ—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è—Ç—å –Ω–æ–≤–æ—Å—Ç—å, —Ç–æ –≤—Å–µ –≤ –µ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ —Å–≤—è–∑–Ω–æ—Å—Ç–∏ –µ–µ –ø–æ–ª—É—á–∞—é—Ç. 

##### –¢–æ–≥–¥–∞ –∑–∞–¥–∞—á–∞ ‚Äî —ç—Ç–æ –ø–æ—Å—á–∏—Ç–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–µ—Ä—à–∏–Ω –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ –∫–∞–∂–¥–æ–π –≤–µ—Ä—à–∏–Ω—ã.

–ù–∞–∏–≤–Ω–æ–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∞ –ø–æ—Ç—Ä–µ–±–æ–≤–∞–ª–æ –±—ã —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –ø–æ–ø–∞—Ä–Ω—ã—Ö —Å–æ—á–µ—Ç–∞–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤–Ω—É—Ç—Ä–∏ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã. –ï—Å–ª–∏ –≥—Ä—É–ø–ø–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç k_i —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤, —Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–±–∞–≤–ª—è–µ–º—ã—Ö —Ä—ë–±–µ—Ä —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç C(k_i, 2) = k_i * (k_i - 1) / 2. –í —Ö—É–¥—à–µ–º —Å–ª—É—á–∞–µ (–≤—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤ –æ–¥–Ω–æ–π –≥—Ä—É–ø–ø–µ), —á–∏—Å–ª–æ —Ä—ë–±–µ—Ä –º–æ–∂–µ—Ç –¥–æ—Å—Ç–∏—á—å O(n^2).

–î–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å–≤—è–∑–Ω–æ—Å—Ç–∏ –Ω–µ –Ω—É–∂–Ω–æ —Å–æ–µ–¥–∏–Ω—è—Ç—å –∫–∞–∂–¥—É—é –ø–∞—Ä—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤–Ω—É—Ç—Ä–∏ –≥—Ä—É–ø–ø—ã. –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å–æ–µ–¥–∏–Ω–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Ü–µ–ø–æ—á–∫—É, —Å–æ—Ö—Ä–∞–Ω—è—è —Å–≤—è–∑–Ω–æ—Å—Ç—å. –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –≥—Ä—É–ø–ø—ã [u‚ÇÅ, u‚ÇÇ, ..., u_k] –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ä—ë–±—Ä–∞: (u‚ÇÅ, u‚ÇÇ), (u‚ÇÇ, u‚ÇÉ), ..., (u_{k-1}, u_k).

–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –≤—Å–µ –≤–µ—Ä—à–∏–Ω—ã –≥—Ä—É–ø–ø—ã –æ–∫–∞–∂—É—Ç—Å—è –≤ –æ–¥–Ω–æ–π –∏ —Ç–æ–π –∂–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ —Å–≤—è–∑–Ω–æ—Å—Ç–∏, –∞ –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä—ë–±–µ—Ä —É–º–µ–Ω—å—à–∏—Ç—Å—è –¥–æ O(‚àë k_i).

---

## –¢–µ—Å—Ç-–∫–µ–π—Å—ã

--–ë—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–∑–∂–µ--